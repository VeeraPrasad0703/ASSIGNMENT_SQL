CREATE DATABASE CUNSULTANCY;
CREATE TABLE DOCTOR(DOCTOR_ID INT PRIMARY KEY NOT NULL,DOCTOR_NAME VARCHAR(30) NOT NULL,
SPECIALIZATION VARCHAR(20) NOT NULL,DOCTOR_AGE INT NOT NULL);
CREATE TABLE PATIENT(PATIENT_ID INT PRIMARY KEY NOT NULL,PATIENT_NAME VARCHAR(30) NOT NULL,
PATIENT_AGE INT NOT NULL,PATIENT_ADDRESS VARCHAR(50));
CREATE TABLE APPOINTENTS(DOCTOR_ID INT,PATIENT_ID INT,
PATIENT_NAME VARCHAR(30) NOT NULL,PATIENT_AGE INT,APPOINTMENT_DATE DATE NOT NULL,FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTOR(DOCTOR_ID),
FOREIGN KEY(PATIENT_ID) REFERENCES PATIENT(PATIENT_ID));
CREATE TABLE REVIEWS(REVIEW_NUMBER INT PRIMARY KEY NOT NULL,DOCTOR_ID INT,
PATIENT_ID INT,REVIEWS VARCHAR(40) NOT NULL,REVIEWED_ON DATE NOT NULL,FOREIGN KEY(PATIENT_ID) REFERENCES PATIENT(PATIENT_ID),FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTOR(DOCTOR_ID));
SELECT * FROM DOCTOR;
SELECT * FROM PATIENT;
RENAME TABLE APPOINTENTS TO APPOINTMENTS;
SELECT * FROM APPOINTMENTS;
SELECT * FROM REVIEWS;
ALTER TABLE APPOINTMENTS ADD COLUMN APPOINTMENT_ID INT PRIMARY KEY NOT NULL;
INSERT INTO DOCTOR VALUES (111,'VEERA','CARDIALOGIST',19), (112,'PRASAD','DERMATOLOGIST',20),
(113,'SUDARSHAN','NEUROLOGIST',20),(114,'DILEEP','PATHOLOGIST',39),(115,'YESWANTH','GENERAL PHYSICIAN',23);

INSERT INTO PATIENT VALUES (101,'SANKAR',19,'KADAPA'),(102,'SURESH',13,'KURNOOL'),
(103,'CHARAN',17,'NELLORE'),(104,'SHANTHAN',52,'INDUKUR'),(105,'PRATHAP',24,'NANDYAL');

INSERT INTO APPOINTMENTS VALUES (111,103,'CHARAN',13,'2023-02-12',1111), (113,101,'SANKAR',19,'2022-02-10',1112),(114,102,'SURESH',13,'2023-05-08',1113);

INSERT INTO REVIEWS VALUES (10001,111,103,'SKILLED DOCTOR','2023-02-23'),(10002,113,101,'GOOD','2022-05-22'),(10003,114,102,'TAKEN GREAT CARE','2023-05-09');

-- PROBLEM STATEMENT 2
CREATE TABLE CONTACTS(
CONTACT_ID INT PRIMARY KEY NOT NULL,
EMAIL VARCHAR(20) NOT NULL,
F_NAME VARCHAR(20) NOT NULL,
L_NAME VARCHAR(20) NOT NULL,
COMPANY VARCHAR(30) NOT NULL,
ACTIVE_FLAG INT,
OPT_OUT INT);

INSERT INTO CONTACTS VALUES(123,"a@a.com","Kian","Seth","ABC",1,1),
(133,"b@a.com","Neha","Seth","ABC",1,0),
(234,"c@c.com","Puru","Malik","CDF",0,0),
(342,"d@d.com","Sid","Maan","TEG",1,0);

SELECT * FROM CONTACTS;

-- 1.Select all columns from the contact table where the active flag is 1
SELECT * FROM CONTACTS WHERE ACTIVE_FLAG=1;

-- 2.Deactivate contacts who are opted out 
UPDATE CONTACTS SET ACTIVE_FLAG=0 WHERE OPT_OUT=1;

SELECT * FROM CONTACTS;

-- 3.Delete all the contacts who have the company name as ‘ABC’
DELETE FROM CONTACTS WHERE COMPANY='ABC';
SELECT * FROM CONTACTS;

-- 4.Insert a new row with id as 658, name as ‘mili’, email as ‘mili@gmail.com’, the company as ‘DGH’, active flag as 1, opt-out flag as 1
INSERT INTO CONTACTS VALUES(658,'mili@gmail.com','MILI','KUN','DGH',1,1);
SELECT * FROM CONTACTS;
delete from CONTACTS where email='mili'; 
-- 5.Pull out the unique values of the company column
SELECT DISTINCT COMPANY FROM CONTACTS;

-- 6.Update name “mili” to “niti”
UPDATE CONTACTS SET F_NAME='NITI' WHERE F_NAME='mili';
SELECT * FROM CONTACTS;

-- PROBLEM STATEMENT 3
CREATE TABLE SALESMAN(
SALESMAN_ID INT PRIMARY KEY NOT NULL,
NAME VARCHAR(50) NOT NULL,
CITY VARCHAR(20) NOT NULL,
COMMISION FLOAT NOT NULL);

CREATE TABLE CUSTOMER(
CUSTOMER_ID INT PRIMARY KEY NOT NULL,
CUSTOMER_NAME VARCHAR(30) NOT NULL,
CITY VARCHAR(20) NOT NULL,
GRADE INT,
SALESMAN_ID INT NOT NULL,FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID));
DROP TABLE CUSTOMER;
INSERT INTO SALESMAN VALUES (5001,'James Hoog','New York',0.15),
(5002,'Nail Knite','Paris',0.13),(5005,'Pit Alex','London',0.11),
 (5006,'Mc Lyon','Paris',0.14),(5007,'Paul Adam','Rome',0.13),
(5003,'Lauson Hen','San Jose',0.12);

INSERT INTO CUSTOMER VALUES(3002,'Nick Rimando','New York',100 ,5001),
(3007,'Brad Davis','New York',  200 ,5001),(3005,'Graham Zusi','California',200,5002),
(3008,'Julian Green', 'London',300,5002),(3004,'Fabian Johnson','Paris',300,5006),
(3009 ,'Geoff Cameron','Berlin',100,5003),(3003,'Jozy Altidor', 'Moscow',200,5007);
INSERT INTO CUSTOMER (CUSTOMER_ID,CUSTOMER_NAME,CITY,SALESMAN_ID)
 VALUES(3001,'Brad Guzan','London',5005);
 SELECT * FROM CUSTOMER;
 SELECT * FROM SALESMAN;

-- Write a SQL query to find those customers with a grade less than 100. It should return cust_name, customer city, grade, salesman, and salesman city. The result should be ordered by ascending customer_id
SELECT C.CUSTOMER_NAME,C.CITY,C.GRADE,S.NAME,S.CITY FROM CUSTOMER C JOIN SALESMAN S ON C.GRADE<100 AND C.SALESMAN_ID=S.SALESMAN_ID;
